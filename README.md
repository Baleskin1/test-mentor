# test-mentor
Тестовое задание на вакансию Software Development Intern (DevOps)

## Задание
Дан набор папок с результатами тестов (в папке logs).
В папке результатов теста лежат папки ft_reference (референсные результаты) и ft_run (результаты тестируемой версии). В них папки проектов, в которых лежат логи, в данном случае файлы "*.stdout".
Для каждого теста создать текстовый файл report.txt в папке теста, проверить результаты (см. ниже),
вывести сообщения о проваленных проверках в report.txt.
Проверки:

1. Проверить, что папки ft_run и ft_reference существуют. Если нет, то вывести сообщение вида: **"directory missing: <имя папки>"** и дальше не проверять тест.
2. Проверить, что в папках ft_run и ft_reference совпадает набор файлов "*.stdout". Если набор файлов не сопадает, вывести в report.txt сообщения такого вида: **"In ft_run there are missing files present in ft_reference: '1/1.stdout', '2/2.stdout', ..."** (для файлов, которых не хватает в ft_run); **"In ft_run there are extra files not present in ft_reference: '1/1.stdout', '2/2.stdout', ..."** (для файлов из ft_run, которых не хватает в ft_reference); и дальше не проверять тест.
3. В файлах "*.stdout" из ft_run надо проверить отсутствие строк с ключевым словом "error" (в любом регистре) и наличие строки, начинающейся с "Solver finished at". Для "error" выводить сообщение: **"<путь к файлу>(<номер строки>): <строка>"**. Для случая отсутствия "Solver finished at" выводить сообщение: **"<путь к файлу>: missing 'Solver finished at'"**.
4. Для файлов "*.stdout" сравнить между собой результаты из ft_reference и из ft_run. Что сравнивать:
   - Для строк вида "Memory Working Set Current = ... Mb, Memory Working Set Peak = ... Mb", брать максимальное число Memory Working Set Peak из всего лога и проверять, что оно отличается не более чем на 50% (по отношению значения из **ft_run** к значению из **ft_reference**). Если проверка не прошла, выводить сообщение **"<путь к файлу>: different 'Memory Working Set Peak' (ft_run=..., ft_reference=..., rel.diff=..., criterion=...)"**.
   - Для строк вида "MESH::Bricks: Total=... Gas=... Solid=... Partial=... Irregular=..." проверять, что число Total (из последней такой строки) отличается не более чем на 10 % (по отношению значения из **ft_run** к значению из **ft_reference**). Если проверка не прошла, выводить сообщение **"<путь к файлу>: different 'Total' of bricks (ft_run=..., ft_reference=..., rel.diff=..., criterion=...)"**.

&emsp;&emsp;&emsp;Величину "rel.diff" (см. выше) при выводе округлять до 2 знаков после запятой.

Для каждого теста, если все проверки прошли, вердикт будет OK, иначе FAIL.

Для каждого теста вывести в STDOUT "<вердикт>: <относительный путь к тесту>" и, если вердикт FAIL, содержимое "report.txt" теста.

Образец вывода см. в "reference_result.txt".


## Результаты
Результаты представлены в *solution.py*

Запуск осуществляется командой:
```console
python3 solution.py
```
Для вывода в файл можно использовать, например:
```console
python3 solution.py > result.txt
```

## Соответствие вывода
Форматно, вывод соответствует референсному при незакомментированной 17-й строке *solution.py*. Иначе - различие в одну строку.
При исполнении на ОС Windows используется кодировка UTF-16 LE.

## Различие вывода
Метод получения референсного файла несколько отличается от задания в отношении проверки **Working Set Peak**. При этом, по заданию:
> ...брать максимальное число Memory Working Set Peak из всего лога...

Но в референсном файле для теста *15-JOULE_HEATING_IN_SOLID/00020-_-1_cond_ss_cond_-3/*, файла *1/1.stdout* есть строка:
> 1/1.stdout: different 'Memory Working Set Peak' (ft_run=10.76, ft_reference=28.18, rel.diff=-0.62, criterion=0.5)

В то время как в самом файле *1/1.stdout* есть строка:
> Memory Working Set Current = 31.61 Mb, Memory Working Set Peak = 31.76 Mb

То есть, максимум - 31.76, **дающий rel.diff в 0.12 < 0.5**, а тогда строки **"different 'Memory Working Set Peak'"** быть не должно

*Касательно приведения вывода в соответствие заданию или референсному файлу, подробнее см. в [Важное замечание](#Важное-замечание)*

## Важное замечание
На 24-й строке *solution.py* находится флаг. Если закомментировать эту строку, задача будет выполнятся в соответствии с заданием. Иначе - в соответствии с референсным выводом.
